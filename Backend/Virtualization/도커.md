도커 : 컨테이너를 독립적으로 실행할 수 있게 해주는 리눅스 기반 가상화 플랫폼.

애플리케이션의 실행 환경 단위로 패키지화하여 리눅스 기반 컨테이너 이미지를 만든다. 

컨테이너 이미지는 컨테이너 레지스트리를 통해 배포된다.

실행 환경별로 패키지화를 하기 때문에 개발 환경에서 바로 운영 환경으로 일관되게 실행할 수 있다.

컨테이너는 리눅스 커널의 기능(cgroups, namespaces)을 사용하여 프로세스를 격리하고, 각 프로세스는 격리된 상황에서 실행할 수 있다.

컨테이너 이미지는 애플리케이션과 dependency를 포함한 읽기 전용 플랫폼이다. 이미지는 여러 레이어로 구성되며,

각 레이어는 애플리케이션을 실행하는 데 필요한 파일과 설정을 포함한다.

이미지는 빌드 후 저장되고, 필요할 때마다 컨테이너로 실행된다.

OS 종류에 상관없이 이미지는 무조건 리눅스 기반으로 생성되며, 호스트OS가 리눅스 계열이 아닌 경우 도커는 가상화된 리눅스 환경에서 컨테이너를 실행한다.

도커 구성요소

    도커 엔진 : 컨테이너를 실행하고 관리하는 역할. 클라이언트-서버 모델 사용.
    도커 클라이언트는 서버인 도커 데몬의 API에 접속해 컨테이너에서 작업을 할 수 있음.

    도커 클라이언트 : 도커와 상호작용하는 인터페이스. 명령어를 통해 도커 서버와 통신한다.

    도커 데몬 : 도커 엔진의 서버 부분으로, 클라이언트 요청을 REST API로 받아 컨테이너로 관리. 
    백그라운드에서(데몬, 상호작용없이 작업을 자동 수행) 실행, 생성, 관리 담당
    dockerd라는 프로세스로 실행됨. 도커 데몬은 도커 객체가 관리하는 대상이다. 
    도커 객체로는 컨테이너, 컨테이너 객체, 네트워크, 컨테이너가 읽고 쓰는 데이터를 지속하기 위한 볼륨 등이 있다.

    컨테이너 이미지 : 애플리케이션 실행 환경을 포함한 읽기 전용 플랫폼. 자동화된 빌드 과정 생성
    클래스와 객체처럼, 정의는 클래스에서 하지만 실질적인 메소드와 변수를 가지고 호출하는 것은 클래스를 기반으로 생성된 객체이다.
    마찬가지로 이미지도 실행이 아닌 정의를 할 뿐, 실질적인 실행은 이미지를 기반으로 생성된 컨테이너가 맡아서 한다.
    컨테이너 이미지는 기본 컨테이너 이미지의 파일 시스템에 새로운 레이어를 겹쳐서 생성한다. 
    이미지의 파일 시스템은 여러 레이어로 구성되며 각 레이어는 직전 레이어의 변경 사항에 대해서 기록한다.
    변경 사항은 하나의 레이어에 기록된다.
    이미지 내의 레이어를 이미지 레이어라고한다. 
    이미지 위에는 프로세스의 파일 추가 및 변경 사항을 기록하는 레이어인 컨테이너 레이너가 있다.

    docker file에 컨테이너 생성 절차를 작성하여 자동으로 이미지를 생성한다.

    도커 레지스트리 : 도커 이미지를 배포하고 저장하는 중앙 저장소. Docker Hub가 대표적이며 다양한 공개 및 개인용 이미지 저장됨.
    이미지를 다운로드하거나 업로드할 수 있음

    도커 컨테이너 : 도커 이미지를 기반으로 실행되는 가벼운 실행 환경. 호스트 OS에서 실행되는 프로세스이다.
    컨테이너 레이어와 컨테이너 이미지, 파일 시스템, 메타데이터, 런타임, 네트워크와 프로세스로 구성된다.
    독립적인 환경에서 라이브러리 및 종속성 파일 포함됨. 읽기/쓰기 가능한 파일 시스템으로 프로세스 격리가 가능함.
    격리를 위해서 네임스페이스라는 구조를 사용한다. 네임스페이스로 PID와 네트워크 인터페이스를 격리할 수 있다.
    컨테이너는 컨테이너 전용 독립 파일 시스템을 사용한다. 프로그램을 한꺼번에 배포하는 형식인 패키지에 의존하면
    파일 시스템 격리 방식에서 유용하다.
    하나의 컨테이너에는 하나의 프로세스가 기준이 된다.

    도커 컴포즈 : 여러 컨테이너들을 구성하고 관리할 수 있는 도구. 복잡한 애플리케이션을 여러 컨테이너로 구성하여 YAML파일로 정의

네임스페이스 : 프로세스가 특정 리소스에 접근하는 것을 제한한다.

격리된 구역에서만 자원을 사용하고 다른 프로세스 자원에는 접근하지 못하게 막는다.

내부에서 외부를 볼 수 없게 하여 외부 리소스 접근을 방지한다.

컨테이너를 실행하게 되면, 데몬이 컨테이너 전용 네임스페이스가 되는 프로세스를 실행한다.

네임스페이스는 특별한 플래그를 지정해 실행하는 프로세스이며 이 프로세스의 자식 프로세스가 네임스페이싀 멤버인 컨테이너 프로세스가 된다.

네임스페이스는 PID, 네트워크 인터페이스, 포트 번호, IPC, 파일 시스템, 호스트명 등의 리소스를 격리할 수 있다.

그러나 네임스페이스로 CPU 코어 수, 메모리 용량, 디스크 I/O 등 하드웨어 리소스 사용량을 제한할 수는 없다.

이를 위해 컨트롤 그룹을 사용하는데, 하드웨어 리소스의 상한선을 설정하여 다른 컨테이너에 미치는 영향을 방지한다.

cgroups라고 부르며 계층 구조이다. cgroupfs라는 인터페이스를 사용하며 하위 cgroup은 상위 cgroup이 설정한 제안을 초과할 수 없다.

차분 관리 : 기준을 정하고 차이점을 기록해 변경 사항을 관리한다.

스웜 모드 : 도커 호스트의 집합으로 구성된 클러스터를 일괄 관리하는 기능이다.

클러스터 내에는 매니저와 워커라는 역할이 있고, 두 역할 동시에 수행할 수도 있다.

매니저는 클러스터를 관리하고 클러스터의 요청을 받는 엔드포인트 역할을 한다.

워커는 매니저의 지시를 따라 컨테이너를 실행한다.

클러스터가 정상 작동 중인 경우를 서비스라고 하고, 매니저의 요청을 받아 워커가 실행하는 컨테이너를 태스크라고 한다.

이 클러스터를 관리하는 도구로 Kubernetes가 등장하였다.